{"title":"Hexo3同时发布到多个仓库","slug":"Hexo3同时发布到多个仓库","date":"2016-03-21T18:03:28.000Z","updated":"2016-03-21T20:20:16.000Z","comments":true,"path":"api/articles/Hexo3同时发布到多个仓库.json","excerpt":"博客很久没有更新，最近看到Hexo的最新版本已经是3打头了，决定升级继续写博客。然而升级的过程像大部分新产品一样，新特性往往用不到，真正用到的坑又多了一些。折腾了近一周，终于又可以像往常一样使用 Hexo g -d 同时发布到两个git平台。下面记录一下遇到的坑和solution。Problem 1. Hexo deployer报错文章Generate正常，进行Deploy时报错。<br>1ERROR Deployer not found: gitSolution:<br>1npm install hexo-deployer-git --save具体可以查看Hexo3 Wiki和Issue#1013。<br>","covers":null,"content":"<p>博客很久没有更新，最近看到Hexo的最新版本已经是3打头了，决定升级继续写博客。然而升级的过程像大部分新产品一样，新特性往往用不到，真正用到的坑又多了一些。折腾了近一周，终于又可以像往常一样使用 <strong>Hexo g -d</strong> 同时发布到两个git平台。下面记录一下遇到的坑和solution。</p>\n<h4 id=\"Problem-1-Hexo-deployer报错\"><a href=\"#Problem-1-Hexo-deployer报错\" class=\"headerlink\" title=\"Problem 1. Hexo deployer报错\"></a>Problem 1. Hexo deployer报错</h4><hr>\n<p>文章Generate正常，进行Deploy时报错。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">ERROR Deployer not found: git</div></pre></td></tr></table></figure></p>\n<p><strong>Solution:</strong><br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">npm install hexo-deployer-git --save</div></pre></td></tr></table></figure></p>\n<p>具体可以查看<a href=\"https://github.com/hexojs/hexo/wiki/Breaking-Changes-in-Hexo-3.0\" target=\"_blank\" rel=\"external\">Hexo3 Wiki</a>和<a href=\"https://github.com/hexojs/hexo/issues/1013\" target=\"_blank\" rel=\"external\">Issue#1013</a>。<br><a id=\"more\"></a></p>\n<h4 id=\"Problem-2-无法同时发布到多个git平台\"><a href=\"#Problem-2-无法同时发布到多个git平台\" class=\"headerlink\" title=\"Problem 2. 无法同时发布到多个git平台\"></a>Problem 2. 无法同时发布到多个git平台</h4><hr>\n<p>包括我在内的一部分人在使用Hexo时，是同时把文章发布到多个git平台的，即使用多个git pages服务。如：github pages和coding pages(原gitcafe pages服务)。然后将国内线路解析到coding pages上，将国外线路解析到github pages上，以保证访问速度和体验。<br>在升级Hexo3之后，同样遇到了文章Generate正常，进行Deploy时报错。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">FATAL fatal: remote part of refspec is not a valid name in HEAD: master</div></pre></td></tr></table></figure></p>\n<p>在使用Hexo2时，同时发布到多个git平台一般会使用下面的_config.yml配置：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">deploy:</div><div class=\"line\">  type: git</div><div class=\"line\">  repo: </div><div class=\"line\">    github: git@github.com:jerry-shao/jerry-shao.github.io.git, master</div><div class=\"line\">    gitcafe: git@gitcafe.com:jerryshao/jerryshao.git, gitcafe-pages</div></pre></td></tr></table></figure></p>\n<p><strong>Solution</strong></p>\n<ol>\n<li>在迁移至coding pages服务后，需要在coding的项目页面手动开启pages服务。这里有一点改进就是coding的pages服务不限定branch的名称，可以自定义pages服务映射的branch。这里我们为了方便，将coding pages这边的branch也改成master。</li>\n<li>_config.yml中的deploy也与之前的写法不同，经过多次尝试，以下配置可以同时发布文章到多个平台。<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">deploy:</div><div class=\"line\">  type: git</div><div class=\"line\">  repo: </div><div class=\"line\">    github: git@github.com:jerry-shao/jerry-shao.github.io.git</div><div class=\"line\">    coding: git@git.coding.net:jerry_shao/jerryshao.io.git</div><div class=\"line\">  branch: master</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>经过修改后使用 <strong>Hexo g -d</strong> 就可以同时发布到github和coding了。</p>\n","more":"</p>\n<h4 id=\"Problem-2-无法同时发布到多个git平台\"><a href=\"#Problem-2-无法同时发布到多个git平台\" class=\"headerlink\" title=\"Problem 2. 无法同时发布到多个git平台\"></a>Problem 2. 无法同时发布到多个git平台</h4><hr>\n<p>包括我在内的一部分人在使用Hexo时，是同时把文章发布到多个git平台的，即使用多个git pages服务。如：github pages和coding pages(原gitcafe pages服务)。然后将国内线路解析到coding pages上，将国外线路解析到github pages上，以保证访问速度和体验。<br>在升级Hexo3之后，同样遇到了文章Generate正常，进行Deploy时报错。<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">FATAL fatal: remote part of refspec is not a valid name in HEAD: master</div></pre></td></tr></table></figure></p>\n<p>在使用Hexo2时，同时发布到多个git平台一般会使用下面的_config.yml配置：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\">deploy:</div><div class=\"line\">  type: git</div><div class=\"line\">  repo: </div><div class=\"line\">    github: git@github.com:jerry-shao/jerry-shao.github.io.git, master</div><div class=\"line\">    gitcafe: git@gitcafe.com:jerryshao/jerryshao.git, gitcafe-pages</div></pre></td></tr></table></figure></p>\n<p><strong>Solution</strong></p>\n<ol>\n<li>在迁移至coding pages服务后，需要在coding的项目页面手动开启pages服务。这里有一点改进就是coding的pages服务不限定branch的名称，可以自定义pages服务映射的branch。这里我们为了方便，将coding pages这边的branch也改成master。</li>\n<li>_config.yml中的deploy也与之前的写法不同，经过多次尝试，以下配置可以同时发布文章到多个平台。<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">deploy:</div><div class=\"line\">  type: git</div><div class=\"line\">  repo: </div><div class=\"line\">    github: git@github.com:jerry-shao/jerry-shao.github.io.git</div><div class=\"line\">    coding: git@git.coding.net:jerry_shao/jerryshao.io.git</div><div class=\"line\">  branch: master</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>经过修改后使用 <strong>Hexo g -d</strong> 就可以同时发布到github和coding了。</p>","categories":[{"name":"Web","path":"api/categories/Web.json"}],"tags":[{"name":"hexo","path":"api/tags/hexo.json"}]}